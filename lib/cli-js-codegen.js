// Generated by CoffeeScript 2.0.0-beta9-dev
var CoffeeScript, fs, path;
fs = require('fs');
path = require('path');
CoffeeScript = require('./module');
module.exports = function (sourceObj, output, options) {
  var cache$, e, inputName, js, jsAST, sourceMap, sourceMappingUrl;
  jsAST = sourceObj.jsAST;
  sourceMap = sourceObj.sourceMap;
  inputName = sourceObj.inputNam;
  try {
    cache$ = CoffeeScript.jsWithSourceMap(jsAST, inputName, { compact: options.minify });
    js = cache$.code;
    sourceMap = cache$.map;
    cache$;
  } catch (e$) {
    e = e$;
    console.error(e.stack || e.message);
    process.exit(1);
  }
  if (options.js) {
    if (options.sourceMapFile) {
      fs.writeFileSync(options.sourceMapFile, '' + sourceMap);
      sourceMappingUrl = options.output ? path.relative(path.dirname(options.output), options.sourceMapFile) : options.sourceMapFile;
      js = '' + js + '\n\n//# sourceMappingURL=' + sourceMappingUrl + '';
    }
    output(js);
    return;
  }
  if (options['eval']) {
    CoffeeScript.register();
    process.argv = [
      process.argv[1],
      options.input
    ].concat(additionalArgs);
    runMain(input, js, jsAST, inputSource);
    return;
  }
};
